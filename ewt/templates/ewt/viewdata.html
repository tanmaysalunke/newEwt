{% extends 'base.html' %}
{% block title %} Register {% endblock %}
    {% block content %}
		<section style="text-align: center; margin-top: 2%;">
    	<h2>{{ request.user.category }}</h2>
		{% if request.user.category == "Manufacturer" %}
			<p>Manufactured Laptops</p>
		{% elif request.user.category == "Recycler" %}
    		<p>Received from the Manufacturer / Refurbisher</p>
		{% elif request.user.category == "Refurbisher" %}
			<p>Received from the Manufacturer</p>
		{% endif %}
    	</section>
	
		<section>
	
      		<table id="disptable">
    			<tr>
    			  	<th>Sr. No.</th>
    			  	<th>Laptops</th>
    			  	<th> <input type="checkbox" class="checkbox" >
    			  	  <span class="checkmark"></span></th>
    			</tr>
				{% for uid in logs %}
					{% if uid.username == request.user.username %}
						<tr>
    					  <td id="test" value='{{ uid.id }}'>{{ uid.id }}</td>
    					  <td><a href="{% url 'replacecomponents' %}">{{ uid.uid_list }}</a></td>
    					  <td><input type="checkbox" name="{{ uid.id }}" class="checkbox">
    					    <span class="checkmark"></span></td>
    					</tr>
					{% endif %}
				{% endfor %}
    		</table>
    	</section>
		<div class="form-group">
			<!-- <label for="category">Category</label> -->
			<!-- <input list="category" name="category" placeholder="Select a Category" class="form-control"> -->
				<select required class="form-control" form="registration" name="menu">
					<option>Category</option>
					{% if request.user.category == "Manufacturer" %}
						<option value="Recycler" id="RC">Recycler</option>
						<option value="Refurbisher" id="RF">Refurbisher</option>
					{% elif request.user.category == "Recycler" %}
    					
					{% elif request.user.category == "Refurbisher" %}
						<option value="Recycler" id="RC">Recycler</option>
					{% endif %}

				</select>                
		</div>
		<div class="form-group">
			<!-- <label for="category">Category</label> -->
			<!-- <input list="category" name="category" placeholder="Select a Category" class="form-control"> -->
				<select required class="form-control" form="registration" name="entrees" id="entrees">
					<option value="" id="">Location</option>
				</select>                
		</div>

		<!-- <button id="myBtn" class="button"><span>Send to Recycler </span></button> -->
		{% if request.user.category == "Manufacturer" %}
			<button type="submit" id="myBtn" class="primary-button" style="margin-bottom: 5%;"><span>Send</span></button>
		{% elif request.user.category == "Recycler" %}
			<button type="submit" id="myBtn" class="primary-button"><span>Mark as Recycled</span></button>
		{% elif request.user.category == "Refurbisher" %}
			<button id="myBtn" class="primary-button" style="margin-bottom: -1%;"><span>Mark as Refurbished</span></button>
			<button type="submit" id="myBtn" class="primary-button"><span>Send to Recycler</span></button>
		{% endif %}


	
  
	

  	<!-- The Modal -->
  	<div id="myModal" class="modal">
	
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close">&times;</span>
        <h1>Successfully marked as recycled</h1>
        <!-- <p>Do you want to send these laptops to the Recycler?</p>
        <div id="modal-button">
					<button id="modal-button-cancel">Cancel</button>
        	<button id="modal-button-confirm">Send to Recycler</button>
				</div> -->
      </div>
	
    </div>

	{% block javascript %}
    <script>
    $(".form-control[name='menu']").change(function () {
        var category = $(".form-control[name='menu']").val();

        $.ajax({
        type: "GET",
        url: '{% url "viewdata1" %}',
        data: {
            'category': category,
        },
        dataType: 'json',
        success: function (data) {
			var $el = $("#entrees");
			$el.empty(); // remove old options
			$.each(data, function(key,value) {
				if($(".form-control[name='menu']").val() == "Category"){
					$el.append($("<option></option>")
			    	.attr("value", "Location").text("Location"));
				}
				else{
					$.each(value, function(key, value){
						//console.log(key, value);
						$el.append($("<option></option>")
			    		.attr("value", value).text(value));
					});
				}
			});

			
        },
        error: function(data){
           alert("Error!");
		   $("#entrees").val("Kurla").change();
           console.log(data);
        }
        });
    });


	$("#myBtn").click(function () {
		$.ajax({
        type: "GET",
        url: '{% url "senddata" %}',
        data: {
            'category': '2,4,5',
			'receiver_category': $(".form-control[name='menu']").val(),
			'receiver_location':$(".form-control[name='entrees']").val()
        },
        dataType: 'json',
        success: function (data) {
			alert("Sent Successfully!") 
			}
		});
	});


       

			
        // },
        // error: function(data){
        //    alert("Error!");
		//    $("#entrees").val("Kurla").change();
        //    console.log(data);
        // }
        // });
    // });


    </script>
    {% endblock %}

    {% endblock %}